{% extends "base.html" %}

{% load static %}

{% load lao_filters %}

{% load i18n %}

{% block title %}{% trans "Restaurant & Dining - Project Pilgrims" %}{% endblock %}

{% block content %}

<style>
    .menu-card {
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .menu-card:hover {
        transform: translateY(-8px) scale(1.02);
    }
    
    .menu-card:hover {
        transform: scale(1.1);
    }
    
    .menu-image {
        transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .category-tab.active {
        transform: translateY(-2px);
    }
    
    .menu-content {
        display: none;
        opacity: 0;
        animation: fadeInUp 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
    }
    
    .menu-content.active {
        display: grid;
        opacity: 1;
    }
    
    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    .description-text {
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
        transition: all 0.3s ease;
    }
    
    .menu-card:hover .description-text {
        -webkit-line-clamp: unset;
    }
    
    .scroll-indicator {
        animation: bounce 2s infinite;
    }
    
    @keyframes bounce {
        0%, 20%, 50%, 80%, 100% {
            transform: translateX(0);
        }
        40% {
            transform: translateX(-10px);
        }
        60% {
            transform: translateX(-5px);
        }
    }

    @keyframes spin-slow {
        from {
            transform: rotate(0deg);
        }
        to {
            transform: rotate(360deg);
        }
    }

    .animate-spin-slow {
        animation: spin-slow 3s linear infinite;
    }
</style>

<!-- Restaurant Hero -->
<section class="relative text-white">
    <div class="bg-cover bg-center h-96" style="background-image: url('{% static 'images/1.jpg' %}');">
        <div class="absolute inset-0 bg-black bg-opacity-50"></div>
        <div class="container mx-auto px-4 h-full flex items-center justify-center relative z-10">
            <div class="text-center max-w-3xl">
                <h1 class="text-4xl md:text-5xl font-serif font-bold leading-tight mb-4">
                    {% trans "Culinary Journey" %}
                </h1>
                <p class="text-xl mb-8">
                     {% trans "Experience culinary excellence at our luxurious restaurant, where every dish tells a story." %}
                </p>
                <a href="#menu" class="bg-primary hover:bg-primary-dark font-medium px-6 py-3 rounded-md text-center transition duration-300">
                    {% trans "View Our Menu" %}
                </a>
            </div>
        </div>
    </div>
</section>

<!-- Menu Section with Enhanced Grid Design -->
<section id="menu" class="py-16 md:py-24">
    <div class="container mx-auto px-4">
        <!-- Animated section header -->
        <div class="text-center mb-12 md:mb-16 animate-on-scroll opacity-0 translate-y-8">
            <h2 class="text-4xl md:text-5xl lg:text-6xl font-serif font-bold mb-6 leading-tight">
                {% trans "Our Menu" %}
            </h2>
            <div class="w-32 h-1.5 mx-auto mb-8 rounded-full"></div>
            <p class="max-w-3xl mx-auto text-lg md:text-xl leading-relaxed">
                {% trans "Explore a diverse menu from around the world, prepared with passion and fine ingredients" %}
            </p>
        </div>
        
        <!-- Enhanced Menu Categories Navigation -->
        <div class="mb-12 md:mb-16">
            <div class="relative mb-8">
                <!-- Mobile scroll indicator -->
                <div class="absolute -top-8 left-0 right-0 text-center text-sm  md:hidden">
                    <span class="scroll-indicator">{% trans "Scroll to see more menu" %} <i class="fas fa-arrow-right text-primary ml-2"></i></span>
                </div>
                
                <!-- Menu tabs with enhanced design -->
                <div class="flex overflow-x-auto pb-4 scrollbar-thin scrollbar-thumb-primary scrollbar-track-transparent gap-3">
                    <div class="flex flex-nowrap gap-3 mx-auto min-w-max">
                        {% for category_data_item in menu_data %}
                        <button class="category-tab {% if forloop.first %}active bg-primary text-white{% else %}bg-white border border-gray-200 text-gray-700{% endif %} px-6 py-4 rounded-2xl font-semibold transition-all duration-300 shadow-lg hover:shadow-xl whitespace-nowrap" data-target="{{ category_data_item.category.slug }}">
                            <i class="{{ category_data_item.category.icon }} mr-3 text-lg"></i>{% trans category_data_item.category.name %}
                        </button>
                        {% endfor %}
                    </div>
                </div>
            </div>
            
            <!-- Category descriptions -->
            <div class="text-center my-8 min-h-16">
                {% for category_data_item in menu_data %}
                <div id="{{ category_data_item.category.slug }}-description" class="category-desc {% if forloop.first %}active{% else %}hidden{% endif %}">
                    <p class="italic text-lg">{% trans category_data_item.category.description %}</p>
                </div>
                {% endfor %}
            </div>
            
            <!-- Enhanced Menu Content with Modern Grid -->

            <!-- Dynamic Menu Content with Modern Grid -->
            {% for category_data_item in menu_data %}
            <div id="{{ category_data_item.category.slug }}-menu" class="menu-content {% if forloop.first %}active{% endif %} grid grid-cols-1 gap-6">
                {% for item in category_data_item.items %}
                <a href="{% url 'menu-item-detail-page' item.slug %}" class="group">
                <div class="menu-card border border-primary/10 hover:border-primary/30 rounded-3xl p-6 group hover:shadow-2xl hover:shadow-primary/20 transition-all duration-300">
                    <div class="relative overflow-hidden rounded-2xl mb-6">
                        {% if item.image %}
                        <img src="{{ item.image.url }}" alt="{{ item.name }}" class="w-full h-full object-cover menu-image">
                        {% else %}
                        <div class="w-full h-full bg-gradient-to-br from-gray-200 to-gray-400 flex items-center justify-center">
                            <i class="fas fa-utensils text-4xl text-white opacity-50"></i>
                        </div>
                        {% endif %}

                        {% if item.is_featured %}
                        <div class="absolute top-4 left-4">
                            <span class="bg-red-500 text-white px-3 py-1 rounded-full text-sm font-semibold">
                                <i class="fas fa-star mr-1"></i>{% trans "Featured" %}
                            </span>
                        </div>
                        {% endif %}
                    </div>
                    <div class="space-y-4">
                        <h3 class="text-2xl font-serif font-bold group-hover:text-primary transition-colors">{{ item.name }}</h3>
                        <p class=" description-text leading-relaxed">
                            {{ item.description }}
                        </p>
                        <div class="flex items-center text-sm ">
                            {% if category_data_item.category.icon %}
                            <i class="{{ category_data_item.category.icon }} mr-2"></i>
                            {% else %}
                            <i class="fas fa-utensils mr-2"></i>
                            {% endif %}
                            <span>{% trans category_data_item.category.name %}</span>
                            {% if item.is_featured %}
                            <i class="fas fa-star ml-4 mr-2 text-yellow-500"></i>
                            <span>{% trans "Chef's Special" %}</span>
                            {% endif %}
                        </div>
                    </div>
                </div>
                {% empty %}
                <div class="col-span-full border-2 border-dashed border-primary rounded-3xl p-12 text-center">
                    <div class="text-6xl mb-6">
                        {% if category_data_item.category.icon %}
                        <i class="{{ category_data_item.category.icon }}"></i>
                        {% else %}
                        <i class="fas fa-utensils"></i>
                        {% endif %}
                    </div>
                    <h3 class="text-2xl font-semibold  mb-4">{% trans "No items yet for this category." %}</h3>
                    <p class=" max-w-md mx-auto text-lg">
                        {% trans "We are preparing new items for this category. Please check back soon!" %}
                    </p>
                </div>
                {% endfor %}
                </a>
            </div>
            {% endfor %}
            
        </div>
    </div>
    <div class="text-center mt-12">
        <a href="{% url 'menu-page' %}" 
           class="inline-flex items-center bg-primary text-white px-8 py-3 rounded-lg hover:bg-primary-700 transition font-medium">
            <span>{% trans "View Full Menu" %}</span>
            <i class="fas fa-arrow-right ml-2"></i>
        </a>
    </div>
</section>

{% endblock %}

{% block extra_js %}

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const categoryTabs = document.querySelectorAll('.category-tab');
        const menuContents = document.querySelectorAll('.menu-content');
        const categoryDescriptions = document.querySelectorAll('.category-desc');
        
        // Initialize animations
        setTimeout(() => {
            const sectionTitle = document.querySelector('.animate-on-scroll');
            if (sectionTitle) {
                sectionTitle.classList.remove('opacity-0', 'translate-y-8');
                sectionTitle.style.transition = 'all 0.8s cubic-bezier(0.4, 0, 0.2, 1)';
            }
            
            // Animate initial menu items
            animateMenuItems(document.querySelector('.menu-content.active'));
        }, 300);
        
        // Tab functionality
        categoryTabs.forEach(tab => {
            tab.addEventListener('click', function() {
                console.log('Tab clicked:', this.getAttribute('data-target'));
                
                // Remove active state from all tabs
                categoryTabs.forEach(t => {
                    t.classList.remove('active');
                    t.classList.remove('bg-gradient-to-br', 'from-primary', 'to-primary-dark', 'text-white');
                    t.classList.add('bg-white', 'text-gray-700', 'border', 'border-gray-200');
                });
                
                // Add active state to clicked tab
                this.classList.add('active');
                this.classList.remove('bg-white', 'text-gray-700', 'border', 'border-gray-200');
                this.classList.add('bg-gradient-to-br', 'from-primary', 'to-primary-dark', 'text-white');
                
                // Hide all menu content and descriptions
                menuContents.forEach(content => {
                    content.classList.remove('active');
                    content.style.display = 'none';
                });
                
                categoryDescriptions.forEach(desc => {
                    desc.classList.add('hidden');
                    desc.classList.remove('active');
                });
                
                // Show target content and description
                const target = this.getAttribute('data-target');
                const targetContent = document.getElementById(`${target}-menu`);
                const targetDescription = document.getElementById(`${target}-description`);
                
                console.log('Target content found:', targetContent);
                
                if (targetContent) {
                    setTimeout(() => {
                        targetContent.style.display = 'grid';
                        targetContent.classList.add('active');
                        animateMenuItems(targetContent);
                    }, 150);
                }
                
                if (targetDescription) {
                    targetDescription.classList.remove('hidden');
                    targetDescription.classList.add('active');
                }
            });
        });
        
        // Animate menu items with staggered delay
        function animateMenuItems(container) {
            if (!container) return;
            
            const cards = container.querySelectorAll('.menu-card, .empty-state');
            cards.forEach((card, index) => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(30px) scale(0.95)';
                
                setTimeout(() => {
                    card.style.transition = 'all 0.6s cubic-bezier(0.4, 0, 0.2, 1)';
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0) scale(1)';
                }, index * 100);
            });
        }
        
        // Smooth scrolling for menu navigation
        const menuLinks = document.querySelectorAll('a[href="#menu"]');
        menuLinks.forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const menuSection = document.getElementById('menu');
                if (menuSection) {
                    const headerHeight = 80; // Adjust based on your header
                    const menuTop = menuSection.offsetTop - headerHeight;
                    window.scrollTo({
                        top: menuTop,
                        behavior: 'smooth'
                    });
                }
            });
        });
        
        // Enhanced mobile tab scrolling
        const tabsContainer = document.querySelector('.overflow-x-auto');
        if (tabsContainer && window.innerWidth < 768) {
            // Add scroll hint animation
            setTimeout(() => {
                tabsContainer.scrollLeft = 50;
                setTimeout(() => {
                    tabsContainer.scrollLeft = 0;
                }, 800);
            }, 2000);
        }
    });
</script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Menu tab functionality
        const categoryTabs = document.querySelectorAll('.category-tab');
        const menuContents = document.querySelectorAll('.menu-content');
        
        categoryTabs.forEach(tab => {
            tab.addEventListener('click', function() {
                // Remove active class from all tabs
                categoryTabs.forEach(t => {
                    t.classList.remove('active', 'bg-primary', 'text-white');
                    t.classList.add('bg-gray-200', 'hover:bg-primary', ');
                });
                
                // Add active class to clicked tab
                this.classList.add('active', 'bg-primary', 'text-white');
                this.classList.remove('bg-gray-200', 'hover:bg-primary', ');
                
                // Hide all menu content
                menuContents.forEach(content => {
                    content.classList.add('hidden');
                    content.classList.remove('active');
                });
                
                // Show the corresponding menu content
                const target = this.getAttribute('data-target');
                const targetContent = document.getElementById(`${target}-menu`);
                if (targetContent) {
                    targetContent.classList.remove('hidden');
                    targetContent.classList.add('active');
                }
            });
        });
        
        // Smooth scroll to menu section when clicking "View Our Menu" button
        const viewMenuBtn = document.querySelector('a[href="#menu"]');
        if (viewMenuBtn) {
            viewMenuBtn.addEventListener('click', function(e) {
                e.preventDefault();
                const menuSection = document.getElementById('menu');
                if (menuSection) {
                    const headerHeight = document.querySelector('header').offsetHeight;
                    const menuTop = menuSection.getBoundingClientRect().top + window.pageYOffset - headerHeight;
                    window.scrollTo({
                        top: menuTop,
                        behavior: 'smooth'
                    });
                }
            });
        }
    });
</script>

<!-- Enhanced CSS and JavaScript -->
<style>
    .menu-card {
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .menu-card:hover {
        transform: translateY(-8px) scale(1.02);
    }
    
    .menu-card:hover {
        transform: scale(1.1);
    }
    
    .menu-image {
        transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .category-tab.active {
        transform: translateY(-2px);
    }
    
    .menu-content {
        display: none;
        opacity: 0;
        animation: fadeInUp 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
    }
    
    .menu-content.active {
        display: grid;
        opacity: 1;
    }
    
    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    .description-text {
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
        transition: all 0.3s ease;
    }
    
    .menu-card:hover .description-text {
        -webkit-line-clamp: 3;
    }
    
    .line-clamp-2 {
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }
    
    .scroll-indicator {
        animation: bounce 2s infinite;
    }
    
    @keyframes bounce {
        0%, 20%, 50%, 80%, 100% {
            transform: translateX(0);
        }
        40% {
            transform: translateX(-10px);
        }
        60% {
            transform: translateX(-5px);
        }
    }
</style>
{% endblock %}