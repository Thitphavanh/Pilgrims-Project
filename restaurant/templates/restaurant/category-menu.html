{% extends "base.html" %}

{% load static %}

{% load humanize %}

{% block title %}{{ meta_title|default:category_display }} - ເມນູຂອງພວກເຮົາ{% endblock %}

{% block extra_css %}

<style>
    .category-hero {
        background: linear-gradient(135deg, rgba(218, 188, 148, 0.1) 0%, rgba(184, 150, 95, 0.1) 100%);
    }
    
    .menu-card {
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .menu-card:hover {
        transform: translateY(-8px) scale(1.02);
    }
    
    .menu-card:hover {
        transform: scale(1.1);
    }
    
    .menu-image {
        transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .description-text {
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
        transition: all 0.3s ease;
    }
    
    .menu-card:hover .description-text {
        -webkit-line-clamp: 3;
    }
    
    .fade-in {
        animation: fadeInUp 0.6s ease-out forwards;
    }
    
    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    .stagger-animation > * {
        opacity: 0;
        animation: fadeInUp 0.6s ease-out forwards;
    }
    
    .stagger-animation > *:nth-child(1) { animation-delay: 0.1s; }
    .stagger-animation > *:nth-child(2) { animation-delay: 0.2s; }
    .stagger-animation > *:nth-child(3) { animation-delay: 0.3s; }
    .stagger-animation > *:nth-child(4) { animation-delay: 0.4s; }
    .stagger-animation > *:nth-child(5) { animation-delay: 0.5s; }
    .stagger-animation > *:nth-child(6) { animation-delay: 0.6s; }
    .stagger-animation > *:nth-child(7) { animation-delay: 0.7s; }
    .stagger-animation > *:nth-child(8) { animation-delay: 0.8s; }
</style>
{% endblock %}

{% block content %}
<!-- Navigation Breadcrumb -->
<nav class="shadow-sm border-b border-gray-200">
    <div class="container mx-auto px-4 py-4">
        <div class="flex items-center justify-between">
            <!-- Breadcrumbs -->
            <div class="flex items-center space-x-2 text-sm ">
                <a href="{% url 'home-page' %}" class="hover:text-primary transition-colors">
                    <i class="fas fa-home"></i> ໜ້າຫຼັກ
                </a>
                <i class="fas fa-chevron-right text-xs"></i>
                <a href="{% url 'menu-page' %}" class="hover:text-primary transition-colors">ເມນູ</a>
                <i class="fas fa-chevron-right text-xs"></i>
                <span class="font-medium">{{ category_display }}</span>
            </div>
            
            <!-- Quick Actions -->
            <div class="flex items-center space-x-4">
                <a href="{% url 'menu-search-page' %}" 
                   class=" hover:text-primary transition-colors">
                    <i class="fas fa-search"></i>
                </a>
                <a href="{% url 'featured-menu-page' %}" 
                   class=" hover:text-primary transition-colors">
                    <i class="fas fa-star"></i>
                </a>
            </div>
        </div>
    </div>
</nav>

<!-- Category Hero Section -->
<section class="category-hero py-16 md:py-20">
    <div class="container mx-auto px-4">
        <div class="max-w-9xl mx-auto text-center">
            <!-- Category Icon -->
            <div class="mb-6">
                {% if category == 'breakfast' %}
                    <i class="fas fa-coffee text-6xl"></i>
                {% elif category == 'coffee' %}
                    <i class="fas fa-mug-hot text-6xl"></i>
                {% elif category == 'american' %}
                    <i class="fas fa-hamburger text-6xl"></i>
                {% elif category == 'indian' %}
                    <i class="fas fa-pepper-hot text-6xl"></i>
                {% elif category == 'mexican' %}
                    <i class="fas fa-pepper-hot text-6xl"></i>
                {% elif category == 'pizza' %}
                    <i class="fas fa-pizza-slice text-6xl"></i>
                {% elif category == 'local_food' %}
                    <i class="fas fa-utensils text-6xl"></i>
                {% elif category == 'soup_salad_mediterranean' %}
                    <i class="fas fa-leaf text-6xl"></i>
                {% elif category == 'dessert' %}
                    <i class="fas fa-ice-cream text-6xl"></i>
                {% elif category == 'drinks' %}
                    <i class="fas fa-glass-martini-alt text-6xl"></i>
                {% else %}
                    <i class="fas fa-utensils text-6xl"></i>
                {% endif %}
            </div>
            
            <!-- Category Title -->
            <h1 class="text-4xl md:text-5xl lg:text-6xl font-serif font-bold mb-6 leading-tight fade-in">
                {{ category_display }}
            </h1>
            
            <!-- Decorative Line -->
            <div class="w-32 h-1.5 bg-gradient-to-r from-primary to-primary-dark mx-auto mb-8 rounded-full fade-in"></div>
            
            <!-- Category Description -->
            <div class="fade-in">
                {% if category == 'breakfast' %}
                    <p class=" text-lg md:text-xl leading-relaxed max-w-3xl mx-auto">
                        ລີ່ມຕົ້ນວັນຂອງທ່ານດ້ວຍເມນູອາຫານເຊົ້າສຸດແຊບຂອງພວກເຮົາ ທີ່ປຸງສົດໃໝ່ທຸກວັນ
                    </p>
                {% elif category == 'coffee' %}
                    <p class=" text-lg md:text-xl leading-relaxed max-w-3xl mx-auto">
                        ເຄື່ອງດື່ມກາເຟທີ່ຖືກຊົງແບບຊຳນານ ໂດຍໃຊ້ເມັດກາເຟຊັ່ນນຳຈາກທົ່ວໂລກ
                    </p>
                {% elif category == 'american' %}
                    <p class=" text-lg md:text-xl leading-relaxed max-w-3xl mx-auto">
                        ອາຫານຄລາສສິກສະໄຕລ໌ອາເມຣິກາ ທີ່ຖືກປຸງແຕ່ງໂດຍພໍ່ຄົວຂອງເຮົາໃນແນວພິເສດ
                    </p>
                {% elif category == 'indian' %}
                    <p class=" text-lg md:text-xl leading-relaxed max-w-3xl mx-auto">
                        ອາຫານອິນເດຍແບບດັ້ງເດີມ ທີ່ເຕັມໄປດ້ວຍກິ່ນຫອມຂອງເຄື່ອງເທດ ແລະວິທີປຸງແບບດັ້ງເດີມ
                    </p>
                {% elif category == 'mexican' %}
                    <p class=" text-lg md:text-xl leading-relaxed max-w-3xl mx-auto">
                        ອາຫານແມັກຊິໂກທີ່ເຂັ້ມຂົ້ນ ແລະເຕັມໄປດ້ວຍລົດຊາດ ໃຊ້ວັດຖຸດິບສົດ ແລະສູດຕົ້ນສະບັບແທ້
                    </p>
                {% elif category == 'pizza' %}
                    <p class=" text-lg md:text-xl leading-relaxed max-w-3xl mx-auto">
                        ພິຊຊ່າແຮນເມດ ຫນ້າຄຸນນະພາບ ທີ່ປຸງສົດໃໝ່ດ້ວຍສ່ວນປະສົມແບບດັ້ງເດີມ
                    </p>
                {% elif category == 'local_food' %}
                    <p class=" text-lg md:text-xl leading-relaxed max-w-3xl mx-auto">
                        ອາຫານພື້ນເມືອງຈາກແຕ່ລະພາກ ທີ່ໂຊວເອກະລັກຂອງວັດຖຸດິບແລະປະເພນີທ້ອງຖິ່ນ
                    </p>
                {% elif category == 'soup_salad_mediterranean' %}
                    <p class=" text-lg md:text-xl leading-relaxed max-w-3xl mx-auto">
                        ສະຫຼັດສົດ ແລະອາຫານຍອດນິຍົມຈາກພາກມະຕິເຕຣເນຍ ທີ່ເຕັມໄປດ້ວຍສິ່ງທີ່ມີປະໂຫຍດຕໍ່ສຸຂະພາບ
                    </p>
                {% elif category == 'dessert' %}
                    <p class=" text-lg md:text-xl leading-relaxed max-w-3xl mx-auto">
                        ຂອງຫວານແລະເຄຼັດລັບທີ່ຫວານຫໍມ ເຮັດຈາກສ່ວນຜະສົມຄຸນນະພາບສູງ
                    </p>
                {% elif category == 'drinks' %}
                    <p class=" text-lg md:text-xl leading-relaxed max-w-3xl mx-auto">
                        ເຄື່ອງດື່ມທີ່ຊົດຊື່ນ, ຄອກແທວສະເພາະ ແລະເລືອກຄັດສັນແບບພິຖີພິຖັນ
                    </p>
                {% else %}
                    <p class=" text-lg md:text-xl leading-relaxed max-w-3xl mx-auto">
                        ສຳຫຼວດເມນູພິເສດຂອງພວກເຮົາ ທີ່ປຸງແຕ່ງດ້ວຍຄວາມຕັ້ງໃຈແລະວັດຖຸດິບຊັ້ນດີ
                    </p>
                {% endif %}
            </div>
            
            <!-- Stats -->
            <div class="flex justify-center items-center space-x-8 mt-8 fade-in">
                <div class="text-center">
                    <div class="text-2xl font-bold">{{ total_items }}</div>
                    <div class="text-sm ">ລາຍການ</div>
                </div>
                {% if featured_items %}
                <div class="text-center">
                    <div class="text-2xl font-bold">{{ featured_items|length }}</div>
                    <div class="text-sm ">ແນະນຳພິເສດ</div>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</section>

<!-- Category Filters & Sorting -->
<section class="border-b border-gray-200">
    <div class="container mx-auto px-4 py-6">
        <div class="flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0">
            <!-- View Options -->
            <div class="flex items-center space-x-4">
            </div>
            
            <!-- Quick Category Navigation -->
            <div class="hidden md:flex items-center space-x-2">
                <span class=" text-sm">ໝວດອື່ນໆ:</span>
                <div class="flex space-x-2">
                    {% for cat_key, cat_name in categories %}
                    {% if cat_key != category %}
                    <a href="{% url 'menu-by-category-page' cat_key %}" 
                       class="bg-red-100 text-gray-700 px-3 py-1 rounded-full text-sm transition-colors">
                        {{ cat_name }}
                    </a>
                    {% endif %}
                    {% endfor %}
                </div>
            </div>
            
            <!-- Results Count -->
            <div class="text-sm ">
                ສະແດງ {{ menu_items|length }} ຈາກທັງໝົດ {{ total_items }} ລາຍການ
            </div>
        </div>
    </div>
</section>

<!-- Main Menu Items Grid -->
<section class="py-12 bg-gradient-to-br from-primary/5 to-primary-dark/5">
    <div class="container mx-auto px-4">
        {% if menu_items %}
            <!-- Menu Items Grid -->
            <div id="menu-grid" class="grid grid-cols-1 gap-6 stagger-animation">
                {% for item in menu_items %}
                <div class="menu-card border border-primary/10 hover:border-primary/30 rounded-3xl p-6 group hover:shadow-2xl hover:shadow-primary/20">
                    <div class="relative overflow-hidden rounded-2xl mb-6">
                        {% if item.image %}
                        <img src="{{ item.image.url }}" 
                             alt="{{ item.name }}" 
                             class="w-full h-full object-cover menu-image">
                        {% else %}
                        <div class="w-full h-48 bg-gradient-to-br from-primary-light to-primary flex items-center justify-center">
                            {% if category == 'breakfast' %}
                                <i class="fas fa-coffee text-4xl opacity-50"></i>
                            {% elif category == 'coffee' %}
                                <i class="fas fa-mug-hot text-4xl opacity-50"></i>
                            {% elif category == 'american' %}
                                <i class="fas fa-hamburger text-4xl opacity-50"></i>
                            {% elif category == 'indian' %}
                                <i class="fas fa-pepper-hot text-4xl opacity-50"></i>
                            {% elif category == 'mexican' %}
                                <i class="fas fa-pepper-hot text-4xl opacity-50"></i>
                            {% elif category == 'pizza' %}
                                <i class="fas fa-pizza-slice text-4xl opacity-50"></i>
                            {% elif category == 'local_food' %}
                                <i class="fas fa-utensils text-4xl opacity-50"></i>
                            {% elif category == 'soup_salad_mediterranean' %}
                                <i class="fas fa-leaf text-4xl opacity-50"></i>
                            {% elif category == 'dessert' %}
                                <i class="fas fa-ice-cream text-4xl opacity-50"></i>
                            {% elif category == 'drinks' %}
                                <i class="fas fa-glass-martini-alt text-4xl opacity-50"></i>
                            {% else %}
                                <i class="fas fa-utensils text-4xl opacity-50"></i>
                            {% endif %}
                        </div>
                        {% endif %}
                        
                        
                        <!-- Featured Badge -->
                        {% if item.is_featured %}
                        <div class="absolute top-4 left-4">
                            <span class="bg-red-500 px-3 py-1 rounded-full text-sm font-semibold">
                                <i class="fas fa-star mr-1"></i>Featured
                            </span>
                        </div>
                        {% endif %}
                        
            
                    </div>
                    
                    <div class="space-y-4">
                        <h3 class="text-2xl font-serif font-bold group-hover:text-primary transition-colors">
                            {{ item.name }}
                        </h3>
                        
                        <p class=" description-text leading-relaxed">
                            {{ item.description }}
                        </p>
                        
                        <div class="flex items-center justify-between">
                            <div class="flex items-center text-sm text-gray-500">
                                <i class="fas fa-utensils mr-2"></i>
                                <span>{{ category_display }}</span>
                                {% if item.is_featured %}
                                <i class="fas fa-star ml-4 mr-2 text-yellow-500"></i>
                                <span>Chef's Choice</span>
                                {% endif %}
                            </div>
                            
                            <a href="{% url 'menu-item-detail-page' item.slug %}" 
                               class="text-primary hover:text-primary-dark transition-colors">
                                <i class="fas fa-arrow-right"></i>
                            </a>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            
            <!-- Pagination -->
            {% if menu_items.has_other_pages %}
            <div class="mt-16 flex justify-center">
                <nav class="flex items-center space-x-2">
                    {% if menu_items.has_previous %}
                        <a href="?page={{ menu_items.previous_page_number }}" 
                           class="border border-gray-300 text-gray-500 hover:bg-gray-50 hover:text-gray-700 px-4 py-2 rounded-lg transition-colors">
                            <i class="fas fa-chevron-left mr-2"></i>ກ່ອນໜ້າ
                        </a>
                    {% endif %}
                    
                    {% for num in menu_items.paginator.page_range %}
                        {% if menu_items.number == num %}
                            <span class="bg-primary text-white px-4 py-2 rounded-lg font-semibold">{{ num }}</span>
                        {% else %}
                            <a href="?page={{ num }}" 
                               class="border border-gray-300 text-gray-500 hover:bg-gray-50 hover:text-gray-700 px-4 py-2 rounded-lg transition-colors">
                                {{ num }}
                            </a>
                        {% endif %}
                    {% endfor %}
                    
                    {% if menu_items.has_next %}
                        <a href="?page={{ menu_items.next_page_number }}" 
                           class="border border-gray-300 text-gray-500 hover:bg-gray-50 hover:text-gray-700 px-4 py-2 rounded-lg transition-colors">
                            ຕໍ່ໄປ<i class="fas fa-chevron-right ml-2"></i>
                        </a>
                    {% endif %}
                </nav>
            </div>
            {% endif %}
            
        {% else %}
            <!-- Empty State -->
            <div class="text-center py-20">
                <div class="max-w-md mx-auto">
                    <div class="text-8xl text-gray-300 mb-8">
                        {% if category == 'breakfast' %}
                            <i class="fas fa-coffee"></i>
                        {% elif category == 'coffee' %}
                            <i class="fas fa-mug-hot"></i>
                        {% elif category == 'american' %}
                            <i class="fas fa-hamburger"></i>
                        {% elif category == 'indian' %}
                            <i class="fas fa-pepper-hot"></i>
                        {% elif category == 'mexican' %}
                            <i class="fas fa-pepper-hot"></i>
                        {% elif category == 'pizza' %}
                            <i class="fas fa-pizza-slice"></i>
                        {% elif category == 'local_food' %}
                            <i class="fas fa-utensils"></i>
                        {% elif category == 'soup_salad_mediterranean' %}
                            <i class="fas fa-leaf"></i>
                        {% elif category == 'dessert' %}
                            <i class="fas fa-ice-cream"></i>
                        {% elif category == 'drinks' %}
                            <i class="fas fa-glass-martini-alt"></i>
                        {% else %}
                            <i class="fas fa-utensils"></i>
                        {% endif %}
                    </div>
                    <h3 class="text-3xl font-serif font-bold text-gray-700 mb-4">ກຳລັງກະກຽມເມນູ{{ category_display }}</h3>
                    <p class="text-gray-500 text-lg mb-8">
                        ພວກເຮົາກຳລັງກະກຽມເມນູ{{ category_display }}ພິເສດ ຄອຍຕິດຕາມໃນໄວໆນີ້
                    </p>
                    <div class="space-y-4">
                        <a href="{% url 'menu-page' %}" 
                           class="inline-block bg-primary hover:bg-primary-dark text-white px-6 py-3 rounded-xl font-semibold transition-colors">
                            <i class="fas fa-arrow-left mr-2"></i>ກັບໄປເມນູຫຼັກ
                        </a>
                        <br>
                        <a href="{% url 'featured-menu-page' %}" 
                           class="inline-block border-2 border-primary text-primary hover:bg-primary hover:text-white px-6 py-3 rounded-xl font-semibold transition-colors">
                            <i class="fas fa-star mr-2"></i>ເບິ່ງເມນູແນະນຳ
                        </a>
                    </div>
                </div>
            </div>
        {% endif %}
    </div>
</section>

<!-- Call to Action -->
<section class="bg-gradient-to-r from-primary to-primary-dark py-16">
    <div class="container mx-auto px-4 text-center">
        <div class="max-w-4xl mx-auto">
            <h2 class="text-3xl md:text-4xl font-serif font-bold text-white mb-6">
                ພົບເມນູທີ່ທ່ານຊື່ນຊົບແລ້ວບໍ?
            </h2>
            <p class="text-lg md:text-xl mb-8 leading-relaxed">
                ສັ່ງອາຫານດຽວນີ້ ຫຼື ຕິດຕໍ່ພວກເຮົາເພື່ອສອບຖາມເພີ່ມເຕີມ
            </p>
            <div class="flex flex-col sm:flex-row justify-center items-center space-y-4 sm:space-y-0 sm:space-x-6">
                <a href="tel:+856XXXXXXXX" 
                   class="hover:bg-primary-light px-8 py-4 rounded-xl font-semibold text-lg transition-colors">
                    <i class="fas fa-phone mr-2"></i>ສັ່ງອາຫານດຽວນີ້
                </a>
            </div>
        </div>
    </div>
</section>


<!-- JavaScript for Enhanced Interactions -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // View toggle functionality
    const gridViewBtn = document.querySelector('.grid-view-btn');
    const listViewBtn = document.querySelector('.list-view-btn');
    const menuGrid = document.getElementById('menu-grid');
    
    if (listViewBtn && gridViewBtn && menuGrid) {
        listViewBtn.addEventListener('click', function() {
            menuGrid.className = 'grid grid-cols-1 gap-4 stagger-animation';
            gridViewBtn.classList.remove('bg-primary', 'text-white');
            gridViewBtn.classList.add('bg-gray-200', 'text-gray-700');
            listViewBtn.classList.add('bg-primary', 'text-white');
            listViewBtn.classList.remove('bg-gray-200', 'text-gray-700');
        });
        
        gridViewBtn.addEventListener('click', function() {
            menuGrid.className = 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 stagger-animation';
            listViewBtn.classList.remove('bg-primary', 'text-white');
            listViewBtn.classList.add('bg-gray-200', 'text-gray-700');
            gridViewBtn.classList.add('bg-primary', 'text-white');
            gridViewBtn.classList.remove('bg-gray-200', 'text-gray-700');
        });
    }
    
    // Smooth scroll to menu items
    const hash = window.location.hash;
    if (hash === '#menu-items') {
        document.querySelector('#menu-grid').scrollIntoView({
            behavior: 'smooth'
        });
    }
    
    // Analytics tracking (optional)
    document.querySelectorAll('.menu-card').forEach(card => {
        card.addEventListener('click', function(e) {
            if (!e.target.closest('a')) {
                const detailLink = card.querySelector('a[href*="menu_item_detail"]');
                if (detailLink) {
                    detailLink.click();
                }
            }
        });
    });
});
</script>


{% endblock %}